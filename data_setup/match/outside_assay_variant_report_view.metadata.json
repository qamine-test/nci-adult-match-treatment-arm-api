{"options":{"viewOn":"patient","pipeline":[{"$project":{"patientSequenceNumber":1.0,"concordance":1.0,"currentPatientStatus":1.0,"currentStepNumber":1.0,"patientAssignments":1.0,"biopsies":{"$filter":{"input":"$biopsies","as":"biopsy","cond":{"$and":[{"$eq":["$$biopsy.failure",false]},{"$eq":["$$biopsy.associatedPatientStatus","REGISTRATION_OUTSIDE_ASSAY"]}]}}}}},{"$match":{"biopsies":{"$ne":[]}}},{"$addFields":{"outsideBiopsies":{"$filter":{"input":"$biopsies","as":"biopsy","cond":{"$ifNull":["$$biopsy.patientOutsideAssayLabReport",false]}}}}},{"$addFields":{"confirmationBiopsies":{"$filter":{"input":"$biopsies","as":"biopsy","cond":{"$not":{"$ifNull":["$$biopsy.patientOutsideAssayLabReport",false]}}}}}}]},"indexes":[]}